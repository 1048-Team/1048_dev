MTS_heretic_test_subjects_category = {
	MTS_internal_raid = {
		allowed = {
			tag = MTS
		}
		available = {
			NOT = { has_country_flag = MTS_preparing_heretic_raid }
		}
		visible = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
			has_country_flag = MTS_burn_heretics
			FROM = {
				is_owned_by = ROOT
			}
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_mp = 1000 }
			set_temp_variable = { MTS_display_variable_cp = 10 }
			has_manpower > 999
			command_power > 9
		}
		custom_cost_text = MTS_decision_cost_CP_MP_tt
		target_array = ROOT.owned_states
		
		state_target = yes
		on_map_mode = map_only
		days_remove = 30
		days_re_enable = 180
		complete_effect = {
			add_manpower = -1000
			add_command_power = -10
			set_country_flag = MTS_preparing_heretic_raid
		}
		remove_effect = {
			random_list = {
				85 = {
					country_event = militem.pinpoint.1000 #Success
				}
				15 = {
					country_event = militem.pinpoint.1001 #Failure
				}
			}
			clr_country_flag = MTS_preparing_heretic_raid
			set_country_flag = {
				flag = MTS_recently_raided
				days = 60
				value = 1
			}
		}
	}
	MTS_border_raid = {
		allowed = {
			tag = MTS
		}
		available = {
			NOT = { has_country_flag = MTS_preparing_heretic_raid }
		}
		visible = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
			has_country_flag = MTS_burn_heretics
			NOT = { has_country_flag = MTS_preparing_heretic_raid }
			NOT = { has_country_flag = MTS_recently_raided }
			FROM = {
				any_neighbor_state = {
					is_owned_by = MTS
					OWNER = { NOT = { has_war_with = MTS } }
				}
				NOT = { is_owned_by = MTS }
			}
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_mp = 2000 }
			set_temp_variable = { MTS_display_variable_cp = 15 }
			has_manpower > 1999
			command_power > 14
		}
		custom_cost_text = MTS_decision_cost_CP_MP_tt
		
		state_target = yes
		on_map_mode = map_only
		days_remove = 45
		days_re_enable = 240
		complete_effect = {
			add_manpower = -2000
			add_command_power = -15
			set_country_flag = MTS_preparing_heretic_raid
			FROM = {
				ROOT = { set_variable = { MTS_target_state = FROM.id } }
			}
			random_state = {
				limit = {
					is_owned_by = ROOT
					any_neighbor_state = {
						state = ROOT.MTS_target_state
					}
				}
				OWNER = { set_variable = { MTS_attacker_state = PREV.id } }
			}
		}
		remove_effect = {
			start_border_war = {
				change_state_after_war = no
				attacker = {
					state = var:MTS_attacker_state
					num_provinces = 3
					on_win = militem.pinpoint.1002
					on_lose = militem.pinpoint.1003
					on_cancel = militem.pinpoint.1004
				}
				defender = {
					state = var:MTS_target_state
					num_provinces = 3
					on_win = militem.pinpoint.1005
					on_lose = militem.pinpoint.1006
					on_cancel = militem.pinpoint.1004
				}
			}
			set_country_flag = {
				flag = MTS_recently_raided
				days = 60
				value = 1
			}
			clear_variable = MTS_target_state
			clear_variable = MTS_attacker_state
		}
	}
	MTS_delve_into_pony_secrets = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
		}
		visible = {
			has_country_flag = MTS_burn_heretics
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_hp = 750 }
			check_variable = { MTS_heretic_prisoners > 749 }
		}
		custom_cost_text = MTS_decision_cost_HP_tt
		days_remove = 50
		days_re_enable = 150
		complete_effect = {
			set_temp_variable = { MTS_heretic_prisoners_added = -750 }
			MTS_add_new_heretic_prisoners = yes
		}
		modifier = {
			research_speed_factor = 0.1
		}
	}
	MTS_test_physical_limits = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
		}
		visible = {
			has_country_flag = MTS_burn_heretics
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_hp = 1000 }
			check_variable = { MTS_heretic_prisoners > 999 }
		}
		custom_cost_text = MTS_decision_cost_HP_tt
		days_remove = 80
		days_re_enable = 240
		complete_effect = {
			set_temp_variable = { MTS_heretic_prisoners_added = -1000 }
			MTS_add_new_heretic_prisoners = yes
		}
		modifier = {
			production_speed_buildings_factor = 0.15
			political_power_factor = -0.1
		}
	}
	MTS_adapt_adrenal_responses = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
		}
		visible = {
			has_country_flag = MTS_burn_heretics
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_hp = 1500 }
			check_variable = { MTS_heretic_prisoners > 1499 }
		}
		custom_cost_text = MTS_decision_cost_HP_tt
		days_remove = 120
		days_re_enable = 240
		complete_effect = {
			set_temp_variable = { MTS_heretic_prisoners_added = -1500 }
			MTS_add_new_heretic_prisoners = yes
		}
		modifier = {
			army_attack_factor = 0.05
			army_speed_factor = 0.05
			army_org_factor = -0.075
		}
	}
	MTS_project_sunrise = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
		}
		visible = {
			has_country_flag = MTS_burn_heretics
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_hp = 5000 }
			check_variable = { MTS_heretic_prisoners > 4999 }
		}
		custom_cost_text = MTS_decision_cost_HP_tt
		days_remove = 365
		fire_only_once = yes
		complete_effect = {
			set_temp_variable = { MTS_heretic_prisoners_added = -5000 }
			MTS_add_new_heretic_prisoners = yes
		}
		modifier = {
			research_speed_factor = 0.1
			political_power_factor = -0.15
			monthly_population = -0.2
		}
		remove_effect = {
			#country_event = militem.pinpoint.900 #An event of test subject results on utilizing fire magic to cleanse ponies of heresy; should give an org bonus and soft and hard attack bonus to mage companies
			add_to_variable = { MTS_culminating_research = 1 }
		}
	}
	MTS_project_kinesis = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
		}
		visible = {
			has_country_flag = MTS_burn_heretics
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_hp = 7500 }
			check_variable = { MTS_heretic_prisoners > 7499 }
		}
		custom_cost_text = MTS_decision_cost_HP_tt
		days_remove = 365
		fire_only_once = yes
		complete_effect = {
			set_temp_variable = { MTS_heretic_prisoners_added = -7500 }
			MTS_add_new_heretic_prisoners = yes
		}
		modifier = {
			research_speed_factor = 0.1
			political_power_factor = -0.15
			monthly_population = -0.2
		}
		remove_effect = {
			#country_event = militem.pinpoint.901 #An event of test subject results on different kinetic weaponry being utilized to improve how to put down more heretics, although it's not directly part of curing heresy; should give breakthrough and soft attack to infantry equipment
			add_to_variable = { MTS_culminating_research = 1 }
		}
	}
	MTS_project_guardian = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
		}
		visible = {
			has_country_flag = MTS_burn_heretics
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_hp = 4000 }
			check_variable = { MTS_heretic_prisoners > 3999 }
		}
		custom_cost_text = MTS_decision_cost_HP_tt
		days_remove = 365
		fire_only_once = yes
		complete_effect = {
			set_temp_variable = { MTS_heretic_prisoners_added = -4000 }
			MTS_add_new_heretic_prisoners = yes
		}
		modifier = {
			research_speed_factor = 0.1
			political_power_factor = -0.15
			monthly_population = -0.2
		}
		remove_effect = {
			#country_event = militem.pinpoint.902 #An event of test subject results on how some research on pony muscular structure has given rise to some new armor schemes based on earth ponies, to improve the armor of Militem Solar; should give increased defense and armor of tanks, reduced speed
			add_to_variable = { MTS_culminating_research = 1 }
		}
	}
	MTS_project_aero = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
		}
		visible = {
			has_country_flag = MTS_burn_heretics
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_hp = 3500 }
			check_variable = { MTS_heretic_prisoners > 3499 }
		}
		custom_cost_text = MTS_decision_cost_HP_tt
		days_remove = 365
		fire_only_once = yes
		complete_effect = {
			set_temp_variable = { MTS_heretic_prisoners_added = -3500 }
			MTS_add_new_heretic_prisoners = yes
		}
		modifier = {
			research_speed_factor = 0.1
			political_power_factor = -0.15
			monthly_population = -0.2
		}
		remove_effect = {
			#country_event = militem.pinpoint.903 #An event of test subject results how pegasus study have given insights into better plane frames; should give increased agility and production cost
			add_to_variable = { MTS_culminating_research = 1 }
		}
	}
	MTS_project_mage = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
		}
		visible = {
			has_country_flag = MTS_burn_heretics
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_hp = 6000 }
			check_variable = { MTS_heretic_prisoners > 5999 }
		}
		custom_cost_text = MTS_decision_cost_HP_tt
		days_remove = 365
		fire_only_once = yes
		complete_effect = {
			set_temp_variable = { MTS_heretic_prisoners_added = -6000 }
			MTS_add_new_heretic_prisoners = yes
		}
		modifier = {
			research_speed_factor = 0.1
			political_power_factor = -0.15
			monthly_population = -0.2
		}
		remove_effect = {
			#country_event = militem.pinpoint.904 #An event of test subject results on studying unicorn magic and how its tied into the brain about how they've created basic targeting computers for ships; should increase attack and reliability
			add_to_variable = { MTS_culminating_research = 1 }
		}
	}
	MTS_project_hereticus_start = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
			custom_trigger_tooltip = {
				tooltip = MTS_has_completed_most_other_research_projects_tt
				check_variable = { MTS_culminating_research = 4 }
			}
		}
		visible = {
			has_country_flag = MTS_burn_heretics
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_hp = 10000 }
			check_variable = { MTS_heretic_prisoners > 9999 }
		}
		custom_cost_text = MTS_decision_cost_HP_tt
		days_remove = 365
		fire_only_once = yes
		complete_effect = {
			set_temp_variable = { MTS_heretic_prisoners_added = -10000 }
			MTS_add_new_heretic_prisoners = yes
		}
		modifier = {
			research_speed_factor = 0.15
			political_power_factor = -0.25
			monthly_population = -0.35
		}
		remove_effect = {
			set_country_flag = MTS_hereticus_begun
			add_political_power = 100
			add_stability = 0.1
		}
	}
	MTS_project_hereticus_continued = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
		}
		visible = {
			has_country_flag = MTS_burn_heretics
			has_country_flag = MTS_herticus_begun
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_hp = 25000 }
			check_variable = { MTS_heretic_prisoners > 24999 }
		}
		custom_cost_text = MTS_decision_cost_HP_tt
		days_remove = 365
		fire_only_once = yes
		complete_effect = {
			set_temp_variable = { MTS_heretic_prisoners_added = -25000 }
			MTS_add_new_heretic_prisoners = yes
		}
		modifier = {
			research_speed_factor = 0.15
			political_power_factor = -0.25
			monthly_population = -0.35
		}
		remove_effect = {
			set_country_flag = MTS_hereticus_almost_done
			add_political_power = 150
			add_stability = 0.1
			add_war_support = 0.1
		}
	}
	MTS_project_hereticus_finale = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Pinpoint ruling_only = yes }
		}
		visible = {
			has_country_flag = MTS_burn_heretics
			has_country_flag = MTS_hereticus_almost_done
		}
		custom_cost_trigger = {
			set_temp_variable = { MTS_display_variable_hp = 50000 }
			check_variable = { MTS_heretic_prisoners > 49999 }
		}
		custom_cost_text = MTS_decision_cost_HP_tt
		days_remove = 365
		fire_only_once = yes
		complete_effect = {
			set_temp_variable = { MTS_heretic_prisoners_added = -50000 }
			MTS_add_new_heretic_prisoners = yes
		}
		modifier = {
			research_speed_factor = 0.1
			political_power_factor = -0.15
			monthly_population = -0.2
		}
		remove_effect = {
			#country_event = militem.pinpoint.905 #Pinpoint finally has a breakthrough of what could be behind heretical thought, after she basically lobotomizes a test subject
		}
	}
}
MTS_investing_in_ourselves_category = {
	MTS_test_prosperity_add = {
		allowed = {
			tag = MTS
		}
		available = { 
			has_country_leader = { character = MTS_Warm_Night ruling_only = yes }
			is_debug = yes
		}
		complete_effect = {
			random_state = {
				limit = {
					is_owned_by = ROOT
				}
				set_temp_variable = { MTS_state_prosperity_added = 5 }
				MTS_add_state_prosperity = yes
			}
		}
	}
	MTS_add_dynamic_variable = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Warm_Night ruling_only = yes }
			is_debug = yes
		}
		complete_effect = {
			every_state = {
				limit = {
					is_owned_by = ROOT
				}
				add_dynamic_modifier = { modifier = MTS_state_prosperity_modifier }
			}
		}
	}
	MTS_test_state_prosperity_calculate = {
		allowed = {
			tag = MTS
		}
		available = {
			has_country_leader = { character = MTS_Warm_Night ruling_only = yes }
			is_debug = yes
		}
		complete_effect = {
			every_state = {
				limit = {
					is_owned_by = ROOT
				}
				MTS_calculate_state_prosperity = yes
			}
		}
	}
}