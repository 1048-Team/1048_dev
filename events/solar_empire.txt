###Solar Empire Events###

add_namespace = solar

#Start event chain to introduce Aurora
country_event = {
	id = solar.1
	title = solar.1.t
	desc = solar.1.d
	
	is_triggered_only = yes
	
	option = { #Aurora goes to Sanctum Solar
		name = solar.1.a
		ai_chance = { 
		factor = 100 
		}
		
		hidden_effect = {
			EQS = {
				country_event = {
					id = solar.2
					days = 20
					random = 120
					}
				}
			}
		}
	}

#Aurora assigned heresy mission
country_event = {
	id = solar.2
	title = solar.2.t
	desc = solar.2.d
	
	is_triggered_only = yes
		
	option = { #Aurora begins to search for heresy
		name = solar.2.a
		ai_chance = {
			factor = 100
		}
		
		hidden_effect = {
			EQS = {
				country_event = {
					id = solar.3
					days = 5
					random = 48
				}
			}
		}
	}
}

#Aurora begins to shadow Thunderbolt Sentinel
country_event = {
	id = solar.3
	title = solar.3.t
	desc = solar.3.d
	
	is_triggered_only = yes

	option = { #Thunderbolt worries about the declared heretics
		name = solar.3.a
		ai_chance = {
			factor = 100
		}
		
		hidden_effect = {
			EQS = {
				country_event = {
					id = solar.4
					days = 21
					random = 144
				}
			}
		}
	}
}

#Thunderbolt waits for reassignment in Sanctum Solar
country_event = {
	id = solar.4
	title = solar.4.t
	desc = solar.4.d
	
	is_triggered_only = yes

	option = { #Thunderbolt grows wary of Aurora
		name = solar.4.a
		ai_chance = {
			factor = 100
		}
		
		hidden_effect = {
			EQS = {
				country_event = {
					id = solar.5
					days = 14
					random = 288
				}
			}
		}
	}
}

#Thunderbolt helps some harmonists escape Sanctum Solar
country_event = {
	id = solar.5
	title = solar.5.t
	desc = solar.5.d
	
	is_triggered_only = yes

	option = { #Aurora begins to search for heresy
		name = solar.5.a
		ai_chance = {
			factor = 100
		}
		
		hidden_effect = {
			EQS = {
				country_event = {
					id = solar.6
					days = 28
					random = 288
				}
			}
		}
	}
}

#Thunderbolt is arrested by Aurora and Daybreaker
country_event = {
	id = solar.6
	title = solar.6.t
	desc = solar.6.d
	
	is_triggered_only = yes

	option = { #Aurora muses at his impending death
		name = solar.6.a
		ai_chance = {
			factor = 100
		}
		
		hidden_effect = {
			EQS = {
				country_event = {
					id = solar.7
					days = 3
					random = 48
				}
			}
		}
	}
}

#Thunderbolt is prayed to by Aurora, and he gives her the picture of Celestia
country_event = {
	id = solar.7
	title = solar.7.t
	desc = solar.7.d
	
	is_triggered_only = yes

	option = { #Aurora is wary but throws the picture away, not trusting of Thunderbolt
		name = solar.7.a
		ai_chance = {
			factor = 100
			}
			remove_unit_leader = 19
			create_corps_commander = {
				name = "Aurora Shinespark"
				portrait_path = "gfx/leaders/EQS/Aurora_Shinespark.tga"
				traits = { pony_race_trait solaris_inquisitionis protectress_of_the_empress_general promising_general }
				skill = 2
				id = 2
				attack_skill = 3
				defense_skill = 1
				planning_skill = 2
				logistics_skill = 2
				female = yes
			}
			set_country_flag = sentinel_killed
		}
	}

###Opening focus events###
###Left tree###

country_event = {
	id = solar.8
	title = solar.8.t
	desc = solar.8.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.8.a
		ai_chance = {
			factor = 100
		}
		add_stability = -0.03
	}
}

country_event = {
	id = solar.10
	title = solar.10.t
	desc = solar.10.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.10.a
		ai_chance = {
			factor = 100
		}
		109 = {
			add_manpower = -352
		}
		65 = {
			add_manpower = -63
		}
		106 = {
			add_manpower = -721
		}
	}
}

country_event = {
	id = solar.11
	title = solar.11.t
	desc = solar.11.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.11.a
		ai_chance = {
			factor = 100
		}
		add_manpower = -1
		hidden_effect = {
			random_list = {
				60 = {
					set_country_flag = rebels_found
				}
				40 = {
					set_country_flag = rebels_not_found
				}
			}
		}
	}
}

###Right side###
country_event = {
	id = solar.9
	title = solar.9.t
	desc = solar.9.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.9.a
		ai_chance = {
			factor = 100
		}
		add_stability = -0.05
	}
}

country_event = {
	id = solar.12
	title = solar.12.t
	desc = solar.12.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.12.a
		ai_chance = {
			factor = 100
		}
		add_political_power = 20
	}
}

country_event = {
	id = solar.13
	title = solar.13.t
	desc = solar.13.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.8.a
		ai_chance = {
			factor = 100
		}
		add_manpower = -1
		add_stability = 0.01
	}
}

country_event = {
	id = solar.14
	title = solar.14.t
	desc = solar.14.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.14.a
		ai_chance = {
			factor = 100
		}
		add_manpower = -1
	}
}

country_event = {
	id = solar.15
	title = solar.15.t
	desc = solar.15.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.15.a
		ai_chance = {
			factor = 100
		}
		add_manpower = -1
		add_war_support = 0.01
	}
}

country_event = {
	id = solar.16
	title = solar.16.t
	desc = solar.16.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.16.a
		ai_chance = {
			factor = 100
		}
		add_stability = 0.05
		hidden_effect = {
			set_country_flag = rebels_found
		}
	}
}

country_event = {
	id = solar.17
	title = solar.17.t
	desc = solar.17.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.17.a
		ai_chance = {
			factor = 100
		}
		hidden_effect = {
			IF = {
				limit = {
					TAG = EQS
					AND = {
					has_country_flag = rebels_found
					}
				}
				country_event = {
					id = solar.18
					days = 34
				}
			}
			ELSE = {
				country_event = {
					id = solar.19
					days = 34
				}
			}
		}
	}
}

country_event = { #Rebels found, less damage, Starlight and Trixie captured
	id = solar.18
	title = solar.18.t
	desc = solar.18.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.18.a
		ai_chance = {
			factor = 100
		}
		hidden_effect = {
			set_country_flag = starlight_and_trixie_captured
			set_country_flag = unsuccessful_rebellion
			75 = {
				add_dynamic_modifier = {
					modifier = crushed_rebellion
				}
			}
		mark_focus_tree_layout_dirty = yes
	}
		75 = {
			add_manpower = -77213
			damage_building = {
				type = infrastructure
				damage = 3
			}
			remove_building = {
				type = arms_factory
				level = 1
			}
			remove_building = {
				type = industrial_complex
				level = 1
			}
		}
	}
}

country_event = { #Rebels found, less damage, Starlight and Trixie captured
	id = solar.19
	title = solar.19.t
	desc = solar.19.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.19.a
		ai_chance = {
			factor = 100
		}
		hidden_effect = {
			set_country_flag = starlight_and_trixie_escaped
			set_country_flag = successful_rebellion
			75 = {
				add_dynamic_modifier = {
					modifier = damaging_rebellion
					}
				}
			mark_focus_tree_layout_dirty = yes
		}
		75 = {
			add_manpower = -204702
			damage_building = {
				type = infrastructure
				damage = 8
			}
			remove_building = {
				type = arms_factory
				level = 2
			}
			remove_building = {
				type = industrial_complex
				level = 3
			}
		}
	}
}

###Corruption Events###
###Will go from 31-40###
country_event = {
	id = solar.40
	title = solar.40.t
	desc = solar.40.d
	
	is_triggered_only = yes
	
	option = { #Rise my new generals
		name = solar.40.a
		ai_chance = {
			factor = 100
			}
			create_corps_commander = {
				name = "Starlight Glimmer"
				portrait_path = "gfx/leaders/EQS/Starlight_general_2.tga"
				traits = { pony_race_trait military_genius brilliant_strategist }
				skill = 4
				id = 5
				attack_skill = 2
				defense_skill = 3
				planning_skill = 4
				logistics_skill = 3
				female = yes
			}
			create_corps_commander = {
				name = "Trixie Lulamoon"
				portrait_path = "gfx/leaders/EQS/Trixie_2.tga"
				traits = { pony_race_trait stage_performer infantry_leader }
				skill = 3
				id = 6
				attack_skill = 4
				defense_skill = 2
				planning_skill = 2
				logistics_skill = 5
				female = yes
			}
	}
}


###Punishment Events for Manehattan###
###Will go from 41-50###

country_event = {
	id = solar.50
	title = solar.50.t
	desc = solar.50.d
	
	is_triggered_only = yes
	
	option = { #Wipe them out, all of them
		name = solar.50.a
		ai_chance = {
			factor = 100
		}
		
		###Include damage to buildings in the surrounding states, and loss of ponypower###
	}
}
		
###Military events###
###Will go from 51-60###
country_event = { #Purging some heretical commanders
	id = solar.51
	title = solar.51.t
	desc = solar.51.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.51.a
		add_stability = 0.01
		remove_unit_leader = 33
		remove_unit_leader = 49
		remove_unit_leader = 38
		}
	}	

###Crisis Events###
###Events go from 80-100###
###Daybreaker senses Celestia first appearing after Manehattan###
country_event = { #Celestia first minute effects to Daybreaker, only whispers and a presence
	id = solar.80
	title = solar.80.t
	desc = solar.80.d
	
	trigger = {
		date > 1048.10.31
		date < 1049.1.1
		}
		
	mean_time_to_happen = {
		days = 20
		}
	
	option = {
		name = solar.80.a
		add_stability = -0.02
			hidden_effect = {
				add_dynamic_modifier = {
				modifier = slipping_sanity
				}
				set_country_flag = daybreaker_crisis
			}
		}
	}
	
country_event = { #Celestia becomes more discernable, as she is now a shape in Daybreaker's vision at points as she tries a pony for heresy
	id = solar.81
	title = solar.81.t
	desc = solar.81.d
	
	trigger = {
		date > 1049.10.31
		date < 1050.3.1
		}
		
	mean_time_to_happen = {
		days = 90
		}
	
	option = {
		name = solar.81.a
		hidden_effect = {
			set_variable = {
				stability_change = -0.05
				}
			country_event = {
				id = solar.82
				days = 60
				random = 144
				}
			}
		}
	}

country_event = { #Celestia reveals herself and almost prevents Daybreaker from executing the heretic later and Daybreaker becomes more paranoid as she believes she's bewitched
	id = solar.82
	title = solar.82.t
	desc = solar.82.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.82.a
		hidden_effect = {
			add_to_variable = {
				stability_change = -0.05
				}
			set_variable = {
				war_support_change = -0.05
				}
			}
		}
	}
	
country_event = { #Sunset encounters Daybreaker smashing her mirror at the invisible Celestia and finds out what is going on and pledges to find a way to save Daybreaker even though Daybreaker protests
	id = solar.83
	title = solar.83.t
	desc = solar.83.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.83.a
		hidden_effect = {
			set_variable = {
				sunset_zealotry = 1
			}
			add_to_variable = {
				stability_change = -0.1
				}
			set_variable = {
				conscription_factor_change = -0.1
				}
			}
		}
	}
	
country_event = { #Sunset is assigned Aurora and heads to Bales; Sunset can either protest or be grateful for the help, former doesn't make her increase her zealotry, latter does
	id = solar.84
	title = solar.84.t
	desc = solar.84.d
	
	is_triggered_only = yes
	
	option = { #Sunset agrees with Daybreaker
		name = solar.84.a
		ai_chance = {
			factor = 75
		}
		hidden_effect = {
			add_to_variable = {
				stability_change = -0.05
				}
			add_to_variable {
				war_support_change = -0.05
				}
			set_variable = {
				army_speed_change = -0.1
				}
			}
		}
	option = { #Sunset protests against Daybreaker
		name = solar.84.b
		ai_chance = {
			factor = 25
		}
		hidden_effect = {
			add_to_variable = {
				sunset_zealotry = 2
			}
			add_to_variable = {
				stability_change = -0.05
				}
			add_to_variable {
				war_support_change = -0.05
				}
			set_variable = {
				army_speed_change = -0.1
				}
			}
		}
	}
	
country_event = { #Sunset and Aurora get to Bales and find reference to the Alicornis Restoris in the ancient library there; Nebula is encountered and severely injured, with Sunset either healing her or leaving her for dead, latter increasing zealotry; neither kill Nebula, however
	id = solar.85
	title = solar.85.t
	desc = solar.85.d
	
	is_triggered_only = yes
	
	option = { #Sunset heals Nebula
		name = solar.85.a
		ai_chance = {
			factor = 80
		}
		hidden_effect = {
			add_to_variable = {
				sunset_zealotry = -1
			}
			add_to_variable = {
				stability_change = -0.05
				}
			set_variable = {
				factory_output_change = -0.15
				}
			}
		}
	option = { #Sunset leaves Nebula for dead
		name = solar.85.b
		ai_chance = {
			factor = 20
		}
		hidden_effect = {
			add_to_variable = {
				sunset_zealotry = 6
			}
			add_to_variable = {
				stability_change = -0.05
				}
			set_variable = {
				factory_output_change = -0.15
				}
			}
		}
	}
	
country_event = { #Sunset and Aurora find the artifact and first mention of Solar Flare in the vault area, get captured by Bales; Sunset can fight or surrender for the time being, former increasing zealotry
	id = solar.86
	title = solar.86.t
	desc = solar.86.d
	
	is_triggered_only = yes
	
	option = { #Sunset fights
		name = solar.86.a
		ai_chance = {
			factor = 90
		}
		hidden_effect = {
			add_to_variable = {
				sunset_zealotry = 4
			}
			add_to_variable = {
				stability_change = -0.05
				}
			set_variable = {
				conscription_change = -0.005
				}
			}
		}
	option = { #Sunset surrenders
		name = solar.86.b
		ai_chance = {
			factor = 10
		}
		hidden_effect = {
			add_to_variable = {
				stability_change = -0.05
				}
			set_variable = {
				conscription_change = -0.005
				}
			}
		}
	}
	
country_event = { #Sunset and Aurora get help from Astrum, and have a quick fight with Nebula, with Sunset either starting the fight or Aurora, former increasing zealotry
	id = solar.87
	title = solar.87.t
	desc = solar.87.d
	
	is_triggered_only = yes
	
	option = { #Sunset starts fight
		name = solar.87.a
		ai_chance = {
			factor = 60
		}
		hidden_effect = {
			add_to_variable = {
				sunset_zealotry = 4
			}
			add_to_variable = {
				stability_change = -0.15
				}
			set_variable = {
				research_speed_change = -0.2
				}
			}
		}
	option = { #Aurora starts fight
		name = solar.87.b
		ai_chance = {
			factor = 40
		}
		hidden_effect = {
			add_to_variable = {
				stability_change = -0.15
				}
			set_variable = {
				research_speed_change = -0.2
				}
			}
		}
	}
	
country_event = { #Sunset and the others race through the chaotic Canterlot to save Daybreaker with the Alicornis Restoris; Sunset can either be angry or sad to see Celestia in Daybreaker's mind, the former increasing zealotry
	id = solar.88
	title = solar.88.t
	desc = solar.88.d
	
	is_triggered_only = yes
	
	option = { #Sunset angy
		name = solar.88.a
		ai_chance = {
			factor = 70
		}
		hidden_effect = {
			add_to_variable = {
				sunset_zealotry = 2
				}
			}
		}
	option = { #Sunset sad
		name = solar.88.b
		ai_chance = {
			factor = 30
			}
		}
	}

###The fate of Daybreaker###
country_event = { #Should have custom tooltips later
	id = solar.96
	title = solar.96.t
	desc = solar.96.d
	
	is_triggered_only = yes
	
	option = {
		name = solar.96.a
		custom_effect_tooltip = mind_is_variable ###Have it be mysterious, along who knows what will affect Daybreaker's mind
		IF = {
			limit = {
				check_variable = {
					sunset_zealotry > 6
				}
			}
			country_event = {
				id = solar.97
			}
		}
		ELSE_IF = {
			limit = {
				check_variable = {
					sunset_zealotry > 2
				}
			}
			country_event = {
				id = solar.98
			}
		}
		ELSE_IF = {
			limit = {
				check_variable = {
					sunset_zealotry < 3
				}
			}
			country_event = {
				id = solar.99
			}
		}
		ELSE = {
			country_event = {
				id = solar.97
			}
		}
	}
}

country_event = { #Daybreaker is healed and thankful to Sunset
	id = solar.97
	title = solar.97.t
	desc = solar.97.d
	
	is_triggered_only = yes
	
	option = { #Daybreaker is healed fully
		name = solar.97.a
		add_stability = 0.01
		hidden_effect = {
			set_country_flag = daybreaker_reigns
			mark_focus_tree_layout_dirty = yes
			}
		}
	}
	
country_event = { #Daybreaker is partly healed, starts out fine, then collapses and is rushed to the throne room
	id = solar.98
	title = solar.98.t
	desc = solar.98.d
	
	is_triggered_only = yes
	
	option = { #Daybreaker is healed but not fully
		name = solar.98.a
		ai_chance = {
			factor = 30
			}
			hidden_effect = {
			remove_unit_leader = 4
			clr_country_flag = daybreaker_crisis
			country_event = {
				id = solar.100
				days = 1
			}
			}
			add_stability = -0.05
		}
	}
	
country_event = { #Celestia returns and knocks out Aurora and is disappointed in Sunset before knocking her out and starting a civil war
	id = solar.99
	title = solar.99.t
	desc = solar.99.d
	
	is_triggered_only = yes
	
	option = { #Celestia returns
		name = solar.99.a
		ai_chance = {
			factor = 10
			}
			hidden_effect = {
			clr_country_flag = daybreaker_crisis
			end_puppet = WHY
			remove_unit_leader = 1
			remove_unit_leader = 3
			remove_unit_leader = 4
			retire_country_leader = yes
			create_country_leader = {
				name = "Nova Glow"
				expire = "1965.1.1"
				picture = ""
				ideology = solarism
				desc = "POLITICS_NOVA_GLOW_DESC"
				traits = {
					unprepared_warrior
				}
			}
			start_civil_war = {
				ideology = fascism
				size = 0.45
				capital = 75
				states = {
					184 187 223 188 185 108 110 12
				}
				set_cosmetic_tag = EQS_SOL
		}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
			}
			create_country_leader = {
				name = "Princess Celestia"
				expire = "1965.1.1"
				picture = "gfx/leaders/EQS/Celestia_Armor.tga"
				desc = "POLITICS_CELESTIA_DESC"
				ideology = harmonic_monarchy
				female = yes
				traits = {
					princess_in_name_only
				}
			}
			set_popularities = {
				democratic = 45
				fascism = 30
				communism = 5
				neutrality = 20
			}
			set_party_name = {
				ideology = democratic
				name = "Alicorn Rule"
				long_name = "Alicorn Rule"
			}
			set_cosmetic_tag = EQS_CEL
			set_country_flag = equestria_returned
		}
		
		###start civil war here like with NMM civil war and include event for both sides, load new tree for EQS and tag rebels as SOL. Both should have civil war-only trees, Nova Glow gets a trait that is switched if SOL wins###
	}
}


###Choosing a Regent###
###Add more options with new paths over time, Sunset will always be favored, retire them from generalship if chosen###
country_event = { #After being sealed away, discussion is held over who will be the new regent
	id = solar.100
	title = solar.100.t
	desc = solar.100.d
	
	is_triggered_only = yes
	
	option = { #Sunset
		name = solar.98.a
		ai_chance = {
			factor = 60
			}
			hidden_effect = {
			retire_country_leader = yes
			remove_unit_leader = 3
			create_country_leader = {
			name = "Sunset Shimmer"
			expire = "1965.1.1"
			picture = "gfx/leaders/EQS/Sunset.tga"
			desc = "POLITICS_SUNSET_SHIMMER_DESC"
			ideology = solarism
			female = yes
			traits = {
				high_mage_shimmer
				}
			}
		set_country_flag = sunset_is_regent
		mark_focus_tree_layout_dirty = yes
		}
		custom_effect_tooltip = sunset_regent
	}
	option = { #Aurora
		name = solar.100.b
		ai_chance = {
			factor = 40
			}
			hidden_effect = {
			retire_country_leader = yes
			remove_unit_leader = 2
			create_country_leader = {
			name = "Aurora Shinespark"
			expire = "1965.1.1"
			picture = "gfx/leaders/EQS/Aurora_Shinespark.tga"
			desc = "POLITICS_AURORA_SHINESPARK_DESC"
			ideology = solarism
			female = yes
			traits = {
				protectress_of_the_empress
				}
			}
			set_country_flag = aurora_is_regent
			mark_focus_tree_layout_dirty = yes
		}
		custom_effect_tooltip = aurora_regent	
	}
}
			